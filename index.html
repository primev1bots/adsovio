<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Adsgram Debug</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script src="https://api.adsgram.ai/js/sdk.js?2024"></script>

    <style>
        body { font-family: monospace; padding: 20px; background: #000; color: #0f0; }
        .box { border: 1px solid #333; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
        button { padding: 15px; width: 100%; font-size: 16px; cursor: pointer; background: #222; color: white; border: 1px solid #555; }
        #logs { font-size: 12px; white-space: pre-wrap; word-break: break-all; color: #fff; }
    </style>
</head>
<body>

    <h2 style="text-align:center;">DEBUG MODE</h2>
    
    <div class="box">
        <p>Status: <span id="status">Waiting...</span></p>
        <p>Block ID: int-19079</p>
    </div>

    <button id="btn" onclick="showAd()">SHOW AD (Click Me)</button>

    <h3>Logs:</h3>
    <div id="logs" class="box"></div>

    <script>
        // Logger Function (Screen এ এরর দেখার জন্য)
        function log(msg) {
            const logBox = document.getElementById('logs');
            logBox.innerHTML += `> ${msg}\n`;
            console.log(msg);
        }

        const BLOCK_ID = "int-19079"; 

        // 1. Check if Telegram WebApp is ready
        window.addEventListener('DOMContentLoaded', () => {
            log("App Loaded.");
            
            if (window.Telegram && window.Telegram.WebApp) {
                log("Telegram WebApp Detected ✅");
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
            } else {
                log("WARNING: Not in Telegram or WebApp script missing ❌");
            }

            if (window.Adsgram) {
                log("Adsgram SDK Loaded ✅");
                document.getElementById('status').innerText = "SDK Ready";
            } else {
                log("ERROR: Adsgram SDK NOT Loaded ❌. Check AdBlock/DNS.");
                document.getElementById('status').innerText = "SDK Failed";
            }
        });

        async function showAd() {
            log("Attempting to show ad...");
            
            if (!window.Adsgram) {
                log("STOP: SDK is missing.");
                alert("SDK Missing!");
                return;
            }

            try {
                const AdController = window.Adsgram.init({ 
                    blockId: BLOCK_ID, 
                    debug: true // Debug mode অন করা হলো
                });

                log("Controller Initialized. Calling show()...");

                await AdController.show().then((result) => {
                    log("SUCCESS: Ad watched!");
                    alert("Reward Earned!");
                }).catch((result) => {
                    log("FAILED/SKIPPED: " + JSON.stringify(result));
                    alert("Failed: " + (result?.description || "Unknown error"));
                });

            } catch (err) {
                log("CRITICAL ERROR: " + err.message);
                alert("System Error: " + err.message);
            }
        }
    </script>
</body>
</html>
